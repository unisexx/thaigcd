<?php

class Auth extends Public_Controller {

	function __construct()
	{
		parent::__construct();	
	}
	
	function index()
	{
		if(is_login('Administrator')) redirect('users/admin/users');
		$this->template->title('Administator');
		$this->template->set_theme('admin');
		$this->template->set_layout('blank');
		echo login_data('display').save;
		$this->template->build('admin/login');
	}
	
	function signin()
	{
		if($_POST)
		{
			if(login($_POST['username'], $_POST['password']))
			{
				if(is_login('Administrator'))
				{
					redirect('users/admin/users');
				}
				else
				{
					set_caution('error','You don\'t have permission','#login');
					redirect('admin');
				}
			}
			else
			{
				set_caution('error','username or password invalid','#login');
				redirect('admin');
			}	
		}
		else
		{
			set_caution('error','username/password is required','#login');
			redirect('admin');
		}
	}
	
	function signout($id=FALSE)
	{
		logout();
		redirect('users/admin/auth');
	}
}

?>
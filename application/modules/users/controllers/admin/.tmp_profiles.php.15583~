<?php
class Profiles extends Admin_Controller
{
	
	function __construct()
	{
		parent::__construct();
	}
	
	function index()
	{
		$data['user'] = new User($this->session->userdata('id'));
		$this->template->build('admin/user_profile',$data);
	}
	
	function save()
	{
		if($_POST)
		{
			$user = new User($this->session->userdata('id'));
			$_POST[user_id] = $user->id;
			$user->profile->from_array($_POST);
			$user->profile->save();
			set_notify('success', lang('save_data_complete'));
		}
		redirect('users/admin/profiles');
	}
	
	function remove_image()
	{
		$id = $this->profile->get_one('id','user_id',$this->session->userdata('id'));
		$this->profile->delete_file($id,'uploads/user/','avatar');
		$this->profile->delete_file($id,'uploads/user/thumb/','avatar');
		$this->profile->delete_file($id,'uploads/user/50x50/','avatar');
		$this->profile->save(array('id' => $id, 'avatar' => NULL));
		set_caution('success', REMOVE_IMAGE_COMPLETE,'.avatar');
		redirect('user/admin/profile');	
	}

}
?>